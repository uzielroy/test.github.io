<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0045)http://6.869.csail.mit.edu/fa19/schedule.html -->
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Neural Congealing: Aligning Images to a Joint Semantic Atlas</title>
      <link href="style.css" rel="stylesheet" type="text/css">
      <meta name="description" content="Project page for &#39;Neural Congealing: Aligning Images to a Joint Semantic Atlas.&#39;">
      <link rel="icon" href="./pics/wis_logo.jpg">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
      <style>

      </style>
   </head>
   <body>
      <p class="title">Neural Congealing: Aligning Images to a Joint Semantic Atlas</p>
        <table width="999" border="0" align="center" class="menu" style="margin-bottom: 2px">
	<tbody>
      <tr>
        <td style="font-size: 17pt;" align="center">CVPR 2023</td>
      </tr>
    </tbody>
  </table>
      <p class="author">
          <span class="author"><a target="_blank" href="https://www.linkedin.com/in/dolev-ofri/">Dolev Ofri-Amar&nbsp;</a><sup>1</sup></span>
          <span class="author"><a target="_blank" href="https://www.linkedin.com/in/michal-geyer-aa3a021b1">Michal Geyer</a>&nbsp;<sup>1</sup></span>
          <span class="author"><a target="_blank" href="https://ykasten.github.io/">Yoni Kasten</a>&nbsp;<sup>2</sup></span>
         <span class="author"><a target="_blank" href="https://www.weizmann.ac.il/math/dekel/">Tali Dekel</a>&nbsp;<sup>1</sup></span>
      </p>
      <table border="0" align="center" class="affiliations" width="1200px">
         <tbody align="center">
            <tr>
	        <td style="text-align: right; width: 17%; padding: 0px"><img src="./pics/wis_logo.jpg" height="48" alt=""></td>
                <td style="text-align: left; width:20%; ">&nbsp;<sup></sup>&nbsp;<a href="https://www.weizmann.ac.il/pages/"><sup>1</sup> Weizmann Institute of Science</a></td>

            </tr>
         </tbody>
      </table>
    <table border="0" align="center" class="affiliations" width="1200px">
         <tbody align="center">
            <tr>
				<td style="text-align: right; width: 17%; padding: 0px"></td>
               <td style="text-align: left; width:20%; ">&nbsp;<sup>2</sup>&nbsp;<a href="https://www.nvidia.com/en-us/research/">NVIDIA Research</a></td>

            </tr>
         </tbody>
      </table>  <table border="0" align="center" class="menu" style="margin-bottom: 0px;">
         <tbody>
            <tr>
                <td align="center">| <a href="https://arxiv.org/abs/2302.03956" target="_blank">Paper</a> | <a href="./sm/index.html" target="_blank">Supplementary Material</a> | <a href="https://github.com/dolev104/neural_congealing" target="_blank">Code</a> | </td>
            </tr>
         </tbody>
      </table>
	    <div id="video">
	  <table  border="0">
            <tbody>
               <tr>
				   <video autoplay loop muted playsinline width="800">
                     <source src="edit_results/butterflies_gradual_gray.mp4" type="video/mp4">
                  </video>
               </tr>
            </tbody>
         </table>
	   </div>
	   <div class="center">
	   <div class="center">
	   <br>
         <p><span class="section"><b>Abstract</b></span> </p>
         <p> We present Neural Congealing -- a zero-shot self-supervised framework for detecting and jointly aligning semantically-common content across a given set of  images.  Our approach harnesses the power of pre-trained DINO-ViT features to learn: (i) a joint semantic atlas -- a 2D grid that captures the mode of DINO-ViT features in the input set, and (ii) dense mappings from the unified atlas to each of the input images. We derive a new robust self-supervised framework that optimizes the atlas representation and mappings per image set, requiring  only a few real-world images as input without any additional input information (e.g., segmentation masks). Notably, we design our losses and training paradigm to account only for the shared content under severe variations in appearance, pose,  background clutter or other distracting objects.  We demonstrate results on a plethora of challenging image sets   including sets of mixed domains (e.g., aligning images depicting sculpture and artwork of cats), sets depicting related yet different object categories (e.g., dogs and tigers), or domains for which large-scale training data is scarce (e.g., coffee mugs). We thoroughly evaluate our method and show that our test-time optimization approach performs favorably compared to a state-of-the-art method that requires extensive training on large-scale datasets.   &nbsp;
         </p>
		 <br>
		   <p class="section"><b>Neural Congealing</b></p>
         
		   <p style="margin-top: 0px;">
            Given an input image set and a pre-trained (and fixed) DINO-ViT model, we extract for each image its keys features and an initial per-image saliency mask which is estimated by applying a clustering-based method directly to the extracted features (see <a target="_blank" href="https://github.com/ShirAmir/dino-vit-features">Amir et al.</a>). These masks may be very coarse and contain many irrelevant objects from the background. Our method is able to locate the common object and ignore the cluttered background.
			 
         </p> 
		   <p style="margin-top: 0px;">
            The results show the input image set, the initial saliency masks and the final congealed images (click on an image for full scale). <br />
			See atlas visualizations in the <a href="./sm/index.html" target="_blank">supplementary page</a>.
			 
         </p> 
      
         <div id="imageCarousel" class="carousel slide" data-ride="carousel" data-interval="5000">
            <div class="carousel-inner">
				<div class="carousel-item active">
                  <a href="congealing_results/ducks_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/ducks_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
				
               <div class="carousel-item">
                  <a href="congealing_results/mug_set_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/mug_set_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
				 <div class="carousel-item">
                  <a href="congealing_results/guitars_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/guitars_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
				<div class="carousel-item">
                  <a href="congealing_results/mix_animals2_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/mix_animals2_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
                <div class="carousel-item">
                  <a href="congealing_results/owls_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/owls_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
               <div class="carousel-item">
                  <a href="congealing_results/teapots_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/teapots_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
               
                <div class="carousel-item">
                  <a href="congealing_results/unique_cats_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/unique_cats_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
				
               <div class="carousel-item">
                  <a href="congealing_results/mugs_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/mugs_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
				<div class="carousel-item">
                  <a href="congealing_results/mix_animals1_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/mix_animals1_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
				<div class="carousel-item">
                  <a href="congealing_results/mix_cats_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/mix_cats_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
				
				<div class="carousel-item">
                  <a href="congealing_results/baby_animals_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/baby_animals_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
                <div class="carousel-item">
                  <a href="congealing_results/butterflies_congealing_res_grid_orig_sal.png" target="_blank"><img class="d-block w-100" src="congealing_results/butterflies_congealing_res_grid_orig_sal.png" alt="First slide" style="margin-top: 30px;"></a>
               </div>
            </div>
            <a class="carousel-control-prev" href="#imageCarousel" role="button" data-slide="prev">
               <div class="slider-navigation-previous">
                  <svg viewBox="0 0 50 80" xml:space="preserve">
                     <polyline fill="white" stroke-width=".5em" stroke-linecap="round" stroke-linejoin="round" points="45.63,75.8 0.375,38.087 45.63,0.375 "></polyline>
                  </svg>
               </div>
               <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#imageCarousel" role="button" data-slide="next">
               <div class="slider-navigation-next">
                  <svg viewBox="0 0 50 80" xml:space="preserve">
                     <polyline fill="white" stroke-width=".5em" stroke-linecap="round" stroke-linejoin="round" points="0.375,0.375 45.63,38.087 0.375,75.8 "></polyline>
                  </svg>
               </div>
               <span class="sr-only">Next</span>
            </a>
         </div>
		   
		   
		   <br>
		   
		   <p class="section"><b>Editing</b></p>
         <p style="margin-top: 0px;"> Once we have the atlas representation, we can use the average image of all congealed images as a template for editing (right). Then, the edit in the atlas space is automatically propagated back to all original images. <br />
		More editing results in the <a href="./sm/index.html" target="_blank">supplementary page</a>!</p>
<div align="center">
	    <table  border="0">
            <tbody>
               <tr>
                  <td style="padding: 30px">
				   <a href="edit_results/mug_set_propagated_x4_grid.png" target="_blank"><video autoplay loop muted playsinline width="700">
                     <source src="edit_results/mug_set_edits_fade_in_fade_out.mp4" type="video/mp4">
					   </video></a>
				   </td>
				   <td height="100">
					   <a href="edit_results/mug_set_average_orig_and_annotated_checkerboard_grid.png" target="_blank"><img src="./edit_results/mug_set_average_orig_and_annotated_checkerboard_grid.png" alt="" width="140"></a>
				   </td>
				   
               </tr>
               <tr>
                  <td style="padding: 30px" align="center">
				   <a href="edit_results/mix_cats_propagated_x4_grid.png" target="_blank"><video autoplay loop muted playsinline width="700">
                     <source src="edit_results/mix_cats_edits_fade_in_fade_out.mp4" type="video/mp4">
                  </video></a>
				   </td>
				   <td height="100">
					   <a href="edit_results/mix_cats_average_orig_and_annotated_checkerboard_grid.png" target="_blank"><img src="./edit_results/mix_cats_average_orig_and_annotated_checkerboard_grid.png" alt="" width="140"></a>
				   </td>
				   
               </tr>
            </tbody>
         </table>
			 
		  </div>
		  
		  <p class="section"><b>Videos</b></p>
         <p style="margin-top: 0px;">
            Training on representative frames allows us to obtain transformations for all frames in inference, apply an edit in atlas space and map it back to all video frames.
         </p>
         <div align="center">
			 <table  border="0">
            <tbody>
				<tr style="padding: 0px">
                  <td style="padding: 0px;text-align: center">
				   <p>Original video and edited video</p>
				   </td>
				   <td height="100" style="padding: 0px;text-align: center">
					   <p>Average image <br />
							(atlas space)</p>
				   </td>
               </tr>
               <tr>
                  <td style="padding-left: 30px;padding-top: 20px">
				   <video autoplay loop muted playsinline width="650">
                     <source src="video_results/wild_cat_input_and_edited_video.mp4" type="video/mp4">
                  </video>
				   </td>
				   <td height="100">
					   <a href="video_results/wild_cat_average_orig_and_annotated_checkerboard_grid_w.png" target="_blank"><img src="video_results/wild_cat_average_orig_and_annotated_checkerboard_grid_w.png" alt="" width="140"></a>
				   </td>
               </tr>
				<tr>
				   <td style="padding-left: 30px;padding-top: 20px">
				   <video autoplay loop muted playsinline width="650">
                     <source src="video_results/tiger_input_and_edited_video.mp4" type="video/mp4">
                  </video>
				   </td>
					<td height="100">
					   <a href="video_results/tiger_average_orig_and_annotated_checkerboard_grid_w.png" target="_blank"><img src="video_results/tiger_average_orig_and_annotated_checkerboard_grid_w.png" alt="" width="140"></a>
				   </td>
				</tr>
				<tr>
				   <td style="padding-left: 30px;padding-top: 20px">
				   <video autoplay loop muted playsinline width="650">
                     <source src="video_results/dog_input_and_edited_video.mp4" type="video/mp4">
                  </video>
					   <p style="text-align: left">Edit for dog taken from <a href="https://github.com/wpeebles/gangealing/tree/main/assets/objects/dog" target="_blank">here</a>.</p>
				   </td>
					<td height="100">
					   <a href="video_results/dog_average_orig_and_annotated_checkerboard_grid_w.png" target="_blank"><img src="video_results/dog_average_orig_and_annotated_checkerboard_grid_w.png" alt="" width="140"></a>
				   </td>
				</tr>
            </tbody>
         </table>
		  
	   </div>          
     
         <br>
         <p class="section" id="paper"><b>Paper</b></p>
         <table  border="0">
            <tbody>
               <tr>
                  <td height="100"><img src="./pics/paper_cover.png" alt="" width="140" height="167"></td>
				   <td height="100">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                  <td width="750">
                     <p><b>Neural Congealing: Aligning Images to a Joint Semantic Atlas</b><br>
                        Dolev Ofri-Amar, Michal Geyer, Yoni Kasten, Tali Dekel.<br />
                        <br>
                        [<a href="https://arxiv.org/abs/2302.03956" target="_blank" rel="noopener noreferrer">paper</a>]
                     </p>
                  </td>
               </tr>
            </tbody>
         </table>
         <p class="section">&nbsp;</p>
         <p class="section" id="sm"><b>Supplementary Material</b></p>
         <table width="587" height="136" border="0">
            <tbody>
               <tr>
                  <td width="180"><img src="./pics/sm_illustration.png" alt="" height="150"></td>
                  <td align="left">
                     <p>[<a href="./sm/index.html" target="_blank">supplementary page</a>]</p>
                  </td>
               </tr>
            </tbody>
         </table>
		  <p class="section">&nbsp;</p>
		  <p class="section" id="code"><b>Code</b></p>
		  <table  border="0">
            <tbody>
               <tr>
                  <td height="50"><img src="./pics/github_logo.png" alt="" width="60" height="60"></td>
				   <td height="100">&nbsp;&nbsp;&nbsp;&nbsp;</td>
                  <td width="750">
                     <p>
                        [<a href="https://github.com/dolev104/neural_congealing" target="_blank">code</a>]
                     </p>
                  </td>
               </tr>
            </tbody>
         </table>
		  
         <p class="section">&nbsp;</p>
         <p class="section" id="bibtex"><b>Bibtex</b></p>
         <table border="0">
            <tbody>
<pre style=" display: block;
                  background: #eee;
                  white-space: pre;
                  -webkit-overflow-scrolling: touch;
                  max-width: 100%;
                  min-width: 100px;
                  border-radius: 20px;
                  padding: 0;;"> 

  @article{ofriamar2023neural,
           title      = {Neural Congealing: Aligning Images to a Joint Semantic Atlas},
           author     = {Ofri-Amar, Dolev and Geyer, Michal and Kasten, Yoni and Dekel, Tali},
           journal    = {arXiv preprint arXiv:2302.03956},
           year       = {2023}
  }
			  </pre>
				
				<p class="section">&nbsp;</p>
				<p>Code for edit propagation and generating videos is based on the code from <a href="https://github.com/wpeebles/gangealing/blob/main/applications" target="_blank">GANgealing</a>.</p>
            </tbody>
         </table>
      </div>
		   </div>
   </body>
	   
   <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WLX2Z5QLG8');
   </script>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
   <script type="text/javascript">
      $(document).ready(function () {

          if (localStorage.getItem("my_app_name_here-quote-scroll") != null) {
              $(window).scrollTop(localStorage.getItem("my_app_name_here-quote-scroll"));
          }

          $(window).on("scroll", function() {
              localStorage.setItem("my_app_name_here-quote-scroll", $(window).scrollTop());
          });

        });
   </script>
   <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</html>
